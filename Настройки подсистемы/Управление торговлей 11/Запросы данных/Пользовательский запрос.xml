<FixedStructure xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="FixedStructure">
	<Property name="Ключ">
		<Value xmlns:d3p1="http://v8.1c.ru/8.1/data/enterprise/current-config" xsi:type="d3p1:ConstantValueKey.SUI_ПользовательскийЗапрос"/>
	</Property>
	<Property name="Данные">
		<Value xsi:type="Structure">
			<Property name="Использование">
				<Value xsi:type="xs:boolean">true</Value>
			</Property>
			<Property name="ДанныеКонструктора">
				<Value xsi:type="FixedStructure">
					<Property name="ТекстЗапроса">
						<Value xsi:type="xs:string">ВЫБРАТЬ РАЗЛИЧНЫЕ
	спрНоменклатура.Ссылка КАК Номенклатура,
	ЕСТЬNULL(ХарактеристикиНоменклатуры.Ссылка, ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)) КАК Характеристика,
	ЕСТЬNULL(ШтрихкодыНоменклатуры.Штрихкод, "") КАК Штрихкод,
	ЕСТЬNULL(ШтрихкодыНоменклатуры.Упаковка.Наименование, "") КАК Упаковка
ПОМЕСТИТЬ втДанные
ИЗ
	Справочник.Номенклатура КАК спрНоменклатура
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ХарактеристикиНоменклатуры КАК ХарактеристикиНоменклатуры
		ПО (спрНоменклатура.ВидНоменклатуры = ХарактеристикиНоменклатуры.Владелец
				ИЛИ спрНоменклатура.Ссылка = ХарактеристикиНоменклатуры.Владелец)
			И (ХарактеристикиНоменклатуры.Ссылка В (&amp;Характеристика))
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ШтрихкодыНоменклатуры КАК ШтрихкодыНоменклатуры
		ПО (спрНоменклатура.Ссылка = ШтрихкодыНоменклатуры.Номенклатура)
			И (ЕСТЬNULL(ХарактеристикиНоменклатуры.Ссылка, ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)) = ШтрихкодыНоменклатуры.Характеристика)
ГДЕ
	спрНоменклатура.Ссылка В (&amp;Номенклатура)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВидыЦен.Ссылка КАК ВидЦены,
	ВЫБОР
		КОГДА ВидыЦен.Идентификатор = "Розничная"
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Розничная,
	ВЫБОР
		КОГДА ВидыЦен.Идентификатор = "Оптовая"
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Оптовая
ПОМЕСТИТЬ втВидыЦен
ИЗ
	Справочник.ВидыЦен КАК ВидыЦен
ГДЕ
	ВидыЦен.Идентификатор В ("Розничная", "Оптовая")
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ЦеныНоменклатурыСрезПоследних.Номенклатура КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследних.Характеристика КАК Характеристика,
	ЦеныРозничные.Цена КАК ЦенаРозничная,
	ЦеныОптовые.Цена КАК ЦенаОптовая
ПОМЕСТИТЬ втЦены
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			(Номенклатура, Характеристика) В
					(ВЫБРАТЬ
						втДанные.Номенклатура,
						втДанные.Характеристика
					ИЗ
						втДанные)
				И ВидЦены В
					(ВЫБРАТЬ
						втВидыЦен.ВидЦены
					ИЗ
						втВидыЦен)) КАК ЦеныНоменклатурыСрезПоследних
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				,
				(Номенклатура, Характеристика) В
						(ВЫБРАТЬ
							втДанные.Номенклатура,
							втДанные.Характеристика
						ИЗ
							втДанные)
					И ВидЦены В
						(ВЫБРАТЬ
							втВидыЦен.ВидЦены
						ИЗ
							втВидыЦен
						ГДЕ
							втВидыЦен.Розничная)) КАК ЦеныРозничные
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ЦеныРозничные.Номенклатура
			И ЦеныНоменклатурыСрезПоследних.Характеристика = ЦеныРозничные.Характеристика
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				,
				(Номенклатура, Характеристика) В
						(ВЫБРАТЬ
							втДанные.Номенклатура,
							втДанные.Характеристика
						ИЗ
							втДанные)
					И ВидЦены В
						(ВЫБРАТЬ
							втВидыЦен.ВидЦены
						ИЗ
							втВидыЦен
						ГДЕ
							втВидыЦен.Оптовая)) КАК ЦеныОптовые
		ПО ЦеныНоменклатурыСрезПоследних.Номенклатура = ЦеныОптовые.Номенклатура
			И ЦеныНоменклатурыСрезПоследних.Характеристика = ЦеныОптовые.Характеристика
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втВидыЦен
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втДанные.Номенклатура.Артикул КАК Артикул,
	втДанные.Номенклатура.Наименование КАК Номенклатура,
	ЕСТЬNULL(втДанные.Характеристика.Наименование, "") КАК Характеристика,
	СТРОКА(ЕСТЬNULL(втЦены.ЦенаРозничная, 0)) КАК ЦенаРозничная,
	СТРОКА(ЕСТЬNULL(втЦены.ЦенаОптовая, 0)) КАК ЦенаОптовая,
	втДанные.Штрихкод КАК Штрихкод,
	&amp;ДатаЗапроса КАК Дата,
	втДанные.Упаковка КАК Упаковка
ИЗ
	втДанные КАК втДанные
		ЛЕВОЕ СОЕДИНЕНИЕ втЦены КАК втЦены
		ПО (втДанные.Номенклатура = втЦены.Номенклатура)
			И (втДанные.Характеристика = втЦены.Характеристика)
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втДанные
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втЦены</Value>
					</Property>
					<Property name="ВыполнятьВПакетномРежиме">
						<Value xsi:type="xs:boolean">false</Value>
					</Property>
					<Property name="ПакетыРезультата">
						<Value xsi:type="Array"/>
					</Property>
				</Value>
			</Property>
		</Value>
	</Property>
</FixedStructure>